{ "name": "Captcha",
  "memberOf": "wix-crm",
  "mixes": [],
  "labels":
    [ "changed" ],
  "location":
    { "lineno": 1,
      "filename": "index.js" },
  "docs":
    { "summary": "The CAPTCHA API is used to display a modal that presents a challenge-response test to determine whether a \nsite visitor is a human or a bot.",
      "description":
        [ "Use a CAPTCHA challenge-response test to verify that site visitors are human before allowing them full access and permissions to ",
          "your site.",
          "",
          "To use the CAPTCHA API, import `captcha` from the `wix-crm` module:",
          "",
          "  ```javascript",
          "  import { captcha } from 'wix-crm';",
          "  ```" ],
      "links": [],
      "examples": [],
      "extra":
        {  } },
  "properties": [],
  "operations":
    [ { "name": "openCaptchaModal",
        "labels":
          [ "changed" ],
        "nameParams": [],
        "params": [],
        "ret":
          { "type":
              { "name": "Promise",
                "typeParams":
                  [ "string" ] },
            "doc": "Fulfilled - Token to validate with the [authorize()](wix-captcha-backend.html#authorize) function." },
        "locations":
          [ { "lineno": 1,
              "filename": "openCaptchaModal.js" } ],
        "docs":
          { "summary": "Opens a modal that contains a CAPTCHA challenge.",
            "description":
              [ "When `openCaptchaModal()` is called a `token` is created and a CAPTCHA challenge is displayed to the site visitor. In a typical flow,",
                " once the challenge is completed, you pass the token to the backend [`authorize()`](https://www.wix.com/velo/reference/wix-captcha-backend/authorize) ",
                " function for validation.",
                "",
                " If 2 minutes pass without authorization, the token expires and the challenge is reset. The modal remains open and ",
                " displays the message `verification challenge expired`.",
                " ",
                " > **Note:**",
                " > - To ensure complete protection, you must include backend [authorization](https://www.wix.com/velo/reference/wix-captcha-backend/authorize) ",
                " > as a mandatory step of the CAPTCHA validation lifecycle.",
                " > - The `openCaptchaModal()` function requires fewer lines of code and takes up less space on your site page. ",
                " > If you prefer to have more control over the CAPTCHA element, see the CAPTCHA element [here](https://www.wix.com/velo/reference/$w/captcha).",
                "",
                " ### Typical CAPTCHA Modal Lifecycle",
                " ",
                " The following list outlines the steps taken in a typical CAPTCHA modal lifecycle:",
                "",
                "1. An element is hidden, pending CAPTCHA verification.",
                "1. A site visitor completes the CAPTCHA challenge which generates a token.",
                "1. The token is verified using a backend function and the hidden element is now shown." ],
            "links":
              [ "[authorize()](wix-captcha-backend.html#authorize)" ],
            "examples":
              [ { "title": "Full CAPTCHA modal lifecycle scenario",
                  "body":
                    [ "/**************************************",
                      " * Backend code - verify-captcha.jsw *",
                      " *************************************/",
                      "",
                      " import wixCaptchaBackend from 'wix-captcha-backend';",
                      "",
                      " //Authorize token received from the frontend CAPTCHA challenge",
                      " export async function verify(token) {",
                      "    return wixCaptchaBackend.authorize(token)",
                      "    .then(res => res.success)",
                      " }",
                      " ",
                      " /*************",
                      "  * Page code *",
                      "  ************/",
                      " ",
                      " import { captcha } from 'wix-crm';",
                      " import { verify } from 'backend/verify-captcha';",
                      " ",
                      " $w.onReady(function () {",
                      "\t$w('#modalButton').onClick(() => {",
                      "",
                      "    captcha.openCaptchaModal().then(token => {",
                      "      verify(token).then(res => {       ",
                      "        console.log('success', res)",
                      "",
                      "        //Hide Captcha modal and show the hidden element",
                      "        $w('#modalButton').hide();",
                      "        $w('#submit').show(); ",
                      "      })",
                      "    });",
                      "  });",
                      " });" ],
                  "extra":
                    { "description": "This example demonstrates how to use the CAPTCHA modal to restrict access.\n We use two buttons. The submit button is hidden until the token is verified. \n If authorization is successful, the submit button is shown." } } ],
            "extra":
              {  } },
        "extra":
          {  } } ],
  "callbacks": [],
  "messages":
    [ { "name": "Token",
        "locations":
          [ { "lineno": 37,
              "filename": "openCaptchaModal.js" } ],
        "docs":
          { "links": [],
            "examples": [],
            "extra":
              {  } },
        "members":
          [ { "name": "token",
              "type": "string",
              "doc": "The CAPTCHA token to authorize." } ],
        "extra":
          {  },
        "labels":
          [ "removed" ] } ],
  "extra":
    {  } }