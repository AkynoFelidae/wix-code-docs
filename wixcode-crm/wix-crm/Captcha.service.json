{ "name": "Captcha",
  "memberOf": "wix-crm",
  "mixes": [],
  "labels":
    [ "changed" ],
  "location":
    { "lineno": 1,
      "filename": "index.js" },
  "docs":
    { "summary": "The CAPTCHA API is used to display a modal that presents a challenge-response test to determine whether a \nsite visitor is a human or a bot.",
      "description":
        [ "Use a CAPTCHA challenge-response test to verify that site visitors are human before allowing them full access and permissions to ",
          "your site.",
          "",
          "To use the CAPTCHA API, import `captcha` from the `wix-crm` module:",
          "",
          "  ```javascript",
          "  import { captcha } from 'wix-crm';",
          "  ```" ],
      "links": [],
      "examples": [],
      "extra":
        {  } },
  "properties": [],
  "operations":
    [ { "name": "openCaptchaModal",
        "labels":
          [ "changed" ],
        "nameParams": [],
        "params": [],
        "ret":
          { "type":
              { "name": "Promise",
                "typeParams":
                  [ "string" ] },
            "doc": "Fulfilled - Token to send to the backend [authorize()](wix-captcha-backend.html#authorize) function for validation." },
        "locations":
          [ { "lineno": 1,
              "filename": "openCaptchaModal.js" } ],
        "docs":
          { "summary": "Opens a modal that contains a CAPTCHA challenge.",
            "description":
              [ "When `openCaptchaModal()` is called, a `token` is created and a CAPTCHA challenge is displayed to the site visitor. In a typical flow,",
                " once the challenge is completed, you pass the token to the backend [`authorize()`](wix-captcha-backend.html#authorize) ",
                " function for validation.",
                "",
                " If 2 minutes pass without authorization, the token expires and the challenge is reset. The modal remains open and ",
                " displays the message `verification challenge expired`.",
                " ",
                " > **Note:**",
                " > - To ensure complete protection, you must include backend [authorization](wix-captcha-backend.html#authorize) as a mandatory step of the CAPTCHA validation lifecycle.",
                " > - The `openCaptchaModal()` function requires fewer lines of code and takes up less space on your site page than the [CAPTCHA editor element]($w.html#captcha). If you prefer to have more control over the CAPTCHA element, see [here]($w.html#captcha).",
                "",
                " ### Typical CAPTCHA Modal Lifecycle",
                " ",
                " The following list outlines the steps taken in a typical CAPTCHA modal lifecycle:",
                "",
                "1. Part of your site is restricted, hidden, or disabled, pending CAPTCHA verification.",
                "1. A modal that contains a CAPTCHA challenge is displayed to the site visitor.",
                "1. Upon completion of the challenge, a token is created.",
                "1. The token is verified using a backend function and permission is granted to the site visitor." ],
            "links":
              [ "[authorize()](wix-captcha-backend.html#authorize)" ],
            "examples":
              [ { "title": "Open a CAPTCHA challenge modal",
                  "body":
                    [ "import { captcha } from 'wix-crm';",
                      "",
                      "/* Sample token value: '03AGdBq26RuHjx_nBn-t5CmmpYeYIksveP31dIJf_RJVLqfYVcUrTYyvyR9A_5b...'",
                      " */",
                      "",
                      "captcha.openCaptchaModal()",
                      "  .then((token) => {",
                      "    // Log and return the token to verify",
                      "    console.log('verify', token);",
                      "    return token;",
                      "  });",
                      "",
                      "/* Promise resolves to:",
                      " * \"string\"",
                      " */" ],
                  "extra":
                    {  } },
                { "title": "Full CAPTCHA modal lifecycle scenario",
                  "body":
                    [ "/*************************************",
                      " * Backend code - verify-captcha.jsw *",
                      " *************************************/",
                      "",
                      " import wixCaptchaBackend from 'wix-captcha-backend';",
                      "",
                      " // Authorize token received from the frontend CAPTCHA challenge",
                      " export async function verify(token) {",
                      "    return wixCaptchaBackend.authorize(token)",
                      "    .then(res => res.success)",
                      " }",
                      " ",
                      " /*************",
                      "  * Page code *",
                      "  *************/",
                      " ",
                      " import { captcha } from 'wix-crm';",
                      " import { verify } from 'backend/verify-captcha';",
                      " ",
                      " $w.onReady(function () {",
                      "\t$w('#modalButton').onClick(() => {",
                      "",
                      "    captcha.openCaptchaModal().then(token => {",
                      "      verify(token).then(res => {       ",
                      "        console.log('success', res)",
                      "",
                      "        // Hide Captcha modal and show the hidden element",
                      "        $w('#modalButton').hide();",
                      "        $w('#submit').show(); ",
                      "      })",
                      "    });",
                      "  });",
                      " });" ],
                  "extra":
                    { "description": "This example demonstrates how to use the CAPTCHA modal to restrict access.\n We use two buttons. The submit button is hidden until the token is verified. \n If authorization is successful, the submit button is shown." } } ],
            "extra":
              {  } },
        "extra":
          {  } } ],
  "callbacks": [],
  "messages":
    [ { "name": "Token",
        "locations":
          [ { "lineno": 37,
              "filename": "openCaptchaModal.js" } ],
        "docs":
          { "links": [],
            "examples": [],
            "extra":
              {  } },
        "members":
          [ { "name": "token",
              "type": "string",
              "doc": "The CAPTCHA token to authorize." } ],
        "extra":
          {  },
        "labels":
          [ "removed" ] } ],
  "extra":
    {  } }